//https://www.kaggle.com/dansbecker/order-by
//how the number of accidents varies with the day of the week

# input:comments

state_number:Int, state_name:Str, consecutive_number:Int, number_of_vehicle_forms_submitted_all:Int, number_of_motor_vehicles_in_transport_mvit:Int, number_of_parked_working_vehicles:Int, number_of_forms_submitted_for_persons_not_in_motor_vehicles:Int, number_of_persons_not_in_motor_vehicles_in_transport_mvit:Int, number_of_persons_in_motor_vehicles_in_transport_mvit:Int, number_of_forms_submitted_for_persons_in_motor_vehicles:Int, county:Int, city:Int, day_of_crash:Int, month_of_crash:Int, year_of_crash:Int, day_of_week:Int, hour_of_crash:Int, minute_of_crash:Int, national_highway_system:Int, land_use:Int, land_use_name:Str, functional_system:Int, functional_system_name:Str, ownership:Int, ownership_name:Str, route_signing:Int, route_signing_name:Str, trafficway_identifier:Str, trafficway_identifier_2:Str, milepoint:Int, latitude:Dbl, longitude:Dbl, special_jurisdiction:Int, special_jurisdiction_name:Str, first_harmful_event:Int, first_harmful_event_name:Str, manner_of_collision:Int, manner_of_collision_name:Str, relation_to_junction_within_interchange_area:Str, relation_to_junction_specific_location:Int, relation_to_junction_specific_location_name:Str, type_of_intersection:Str, work_zone:Str, relation_to_trafficway:Int, relation_to_trafficway_name:Str, light_condition:Int, light_condition_name:Str, atmospheric_conditions_1:Int, atmospheric_conditions_1_name:Str, atmospheric_conditions_2:Int, atmospheric_conditions_2_name:Str, atmospheric_conditions:Int, atmospheric_conditions_name:Str, school_bus_related:Str, rail_grade_crossing_identifier:Str, hour_of_notification:Int, minute_of_notification:Int, hour_of_arrival_at_scene:Int, minute_of_arrival_at_scene:Int, hour_of_ems_arrival_at_hospital:Int, minute_of_ems_arrival_at_hospital:Int, related_factors_crash_level_1:Int, related_factors_crash_level_1_name:Str, related_factors_crash_level_2:Int, related_factors_crash_level_2_name:Str, related_factors_crash_level_3:Int, related_factors_crash_level_3_name:Str, number_of_fatalities:Int, number_of_drunk_drivers:Int, timestamp_of_crash:Date
19,  Iowa, 190204, 1, 1, 0, 0, 0, 1, 1, 109, 0, 11, 9, 2015, 6, 20, 20, 0, 1,  Rural, 7,  Local, 2,  County Highway Agency, 4,  County Road,  CR-510TH ST,  , 0, 43.49995, -94.03542778, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 1,  Daylight, 1,  Clear, 0,  No Additional Atmospheric Conditions, 1,  Clear,  No, 0, 20, 28, 20, 30, 21, 2, 0,  NULL, 0,  NULL, 0,  NULL, 1, 1,  2015-09-11
19,  Iowa, 190233, 1, 1, 0, 0, 0, 1, 1, 181, 0, 1, 11, 2015, 1, 0, 30, 1, 1,  Rural, 3,  Principal Arterial – Other, 1,  State Highway Agency, 2,  U.S. Highway,  US-65,  , 245, 41.47072778, -93.55844444, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 2,  Dark – Not Lighted, 1,  Clear, 0,  No Additional Atmospheric Conditions, 1,  Clear,  No, 0, 88, 88, 88, 88, 88, 88, 0,  NULL, 0,  NULL, 0,  NULL, 1, 1,  2015-11-01 0:30
19,  Iowa, 190179, 1, 1, 0, 0, 0, 2, 2, 193, 0, 4, 5, 2015, 2, 16, 18, 0, 1,  Rural, 5,  Major Collector, 2,  County Highway Agency, 4,  County Road,  CR-K42 DALLAS AVE,  CR-300TH ST, 0, 42.27207222, -96.23219444, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 3,  Intersection Related,  Four-Way Intersection,  NULL, 4,  On Roadside, 1,  Daylight, 2,  Rain, 0,  No Additional Atmospheric Conditions, 2,  Rain,  No, 0, 16, 27, 16, 34, 17, 1, 0,  NULL, 0,  NULL, 0,  NULL, 1, 0,  2015-05-04
19,  Iowa, 190248, 1, 1, 0, 0, 0, 4, 4, 99, 0, 17, 11, 2015, 3, 12, 26, 1, 1,  Rural, 1,  Interstate, 1,  State Highway Agency, 1,  Interstate,  I-80,  , 188, 41.68193333, -92.98368056, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 1,  Daylight, 10,  Cloudy, 2,  Rain, 2,  Rain,  No, 0, 12, 25, 12, 34, 99, 99, 0,  NULL, 0,  NULL, 0,  NULL, 2, 0,  2015-11-17
19,  Iowa, 190231, 1, 1, 0, 0, 0, 1, 1, 121, 0, 31, 10, 2015, 7, 4, 49, 0, 1,  Rural, 7,  Local, 2,  County Highway Agency, 4,  County Road,  CR-290TH ST,  , 0, 41.22881389, -93.970375, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 2,  Dark – Not Lighted, 2,  Rain, 0,  No Additional Atmospheric Conditions, 2,  Rain,  No, 0, 88, 88, 88, 88, 88, 88, 0,  NULL, 0,  NULL, 0,  NULL, 1, 0,  2015-10-31 4:49
19,  Iowa, 190151, 1, 1, 0, 0, 0, 2, 2, 195, 0, 13, 8, 2015, 5, 9, 9, 1, 1,  Rural, 4,  Minor Arterial, 1,  State Highway Agency, 2,  U.S. Highway,  US-65,  , 50, 43.33623611, -93.21073333, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 1,  Daylight, 1,  Clear, 0,  No Additional Atmospheric Conditions, 1,  Clear,  No, 0, 99, 99, 99, 99, 99, 99, 0,  NULL, 0,  NULL, 0,  NULL, 1, 0,  2015-08-13 9:09
19,  Iowa, 190054, 1, 1, 0, 0, 0, 1, 1, 31, 0, 16, 3, 2015, 2, 99, 99, 0, 1,  Rural, 7,  Local, 2,  County Highway Agency, 4,  County Road,  CR-ROSE AVE,  , 0, 41.80360556, -91.03523056, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 1,  On Roadway, 2,  Dark – Not Lighted, 1,  Clear, 0,  No Additional Atmospheric Conditions, 1,  Clear,  No, 0, 88, 88, 88, 88, 88, 88, 0,  NULL, 0,  NULL, 0,  NULL, 1, 1,  2015-03-16 0:00
19,  Iowa, 190069, 1, 1, 0, 0, 0, 1, 1, 197, 0, 26, 4, 2015, 1, 19, 0, 0, 1,  Rural, 6,  Minor Collector, 2,  County Highway Agency, 4,  County Road,  CR-R27 FRANKLIN AVE,  , 0, 42.58449444, -93.87293611, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 1,  Daylight, 1,  Clear, 0,  No Additional Atmospheric Conditions, 1,  Clear,  No, 0, 88, 88, 88, 88, 88, 88, 0,  NULL, 0,  NULL, 0,  NULL, 1, 1,  2015-04-26
19,  Iowa, 190257, 1, 1, 0, 0, 0, 3, 3, 155, 1900, 4, 12, 2015, 6, 12, 42, 1, 2,  Urban, 1,  Interstate, 1,  State Highway Agency, 1,  Interstate,  I-80/29,  , 52, 41.23126667, -95.84303889, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  Yes, 19,  Other Location Within Interchange Area,  Not an Intersection,  NULL, 4,  On Roadside, 1,  Daylight, 1,  Clear, 0,  No Additional Atmospheric Conditions, 1,  Clear,  No, 0, 99, 99, 99, 99, 99, 99, 0,  NULL, 0,  NULL, 0,  NULL, 1, 0,  2015-12-04
19,  Iowa, 190046, 1, 1, 0, 0, 0, 2, 2, 43, 0, 29, 3, 2015, 1, 2, 34, 0, 1,  Rural, 6,  Minor Collector, 2,  County Highway Agency, 4,  County Road,  CR-X29 GLACIER RD,  , 0, 42.65273056, -91.37642222, 0,  No Special Jurisdiction (Includes National Forests Since 2008), 1,  Rollover/Overturn, 0,  Not Collision with Motor Vehicle in Transport (Not Necessarily in Transport for\n2005-2009),  No, 1,  Non-Junction,  Not an Intersection,  NULL, 4,  On Roadside, 2,  Dark – Not Lighted, 10,  Cloudy, 0,  No Additional Atmospheric Conditions, 10,  Cloudy,  No, 0, 99, 99, 99, 99, 99, 99, 0,  NULL, 0,  NULL, 0,  NULL, 1, 1,  2015-03-29 2:34

# constraint

{
  "constants": [],
  "aggregation_functions": []
}

# output

num_accidents:Int,day_of_week:Int
3,1
2,6
2,2
1,3
1,7
1,5

# solution

```sql
SELECT COUNT(consecutive_number) AS num_accidents, 
       EXTRACT(DAYOFWEEK FROM timestamp_of_crash) AS day_of_week
FROM `bigquery-public-data.nhtsa_traffic_fatalities.accident_2015`
GROUP BY day_of_week
ORDER BY num_accidents DESC
```
